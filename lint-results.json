
> notus@0.1.0 lint
> eslint src/ --format json

[{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\actions\\commentActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\actions\\folderActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\actions\\notificationActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\actions\\tagActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\actions\\userActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(auth)\\forgot-password\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(auth)\\forgot-password\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(auth)\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(auth)\\login\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(auth)\\login\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(auth)\\register\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(auth)\\register\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(auth)\\reset-password\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(auth)\\reset-password\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(auth)\\verify-email\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(auth)\\verify-email\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(legal)\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(legal)\\legal\\cgu\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(legal)\\legal\\cgu\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(legal)\\legal\\rgpd\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(legal)\\legal\\rgpd\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\favorites\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\folders\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\folders\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\profile\\BackofficeEditButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\profile\\ProfileEditButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\profile\\delete\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\profile\\delete\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\profile\\edit\\EditProfilePageClient.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":179,"column":13,"nodeType":"JSXOpeningElement","endLine":183,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useActionState, useEffect, useMemo, useRef, useState, startTransition } from \"react\";\r\nimport { Button, Card, Input, ImageUpload } from \"@/components/ui\";\r\nimport Icon from \"@/components/Icon\";\r\nimport { updateUserProfileAction } from \"@/lib/actions\";\r\nimport { useGuardedNavigate } from \"@/hooks/useGuardedNavigate\";\r\nimport { useSession } from \"next-auth/react\";\r\nimport { saveUserSession } from \"@/lib/session-utils\";\r\nimport { useImageValidation } from \"@/hooks/useImageValidation\";\r\nimport Link from \"next/link\";\r\n\r\ninterface User {\r\n  id?: string;\r\n  username?: string;\r\n  firstName?: string;\r\n  lastName?: string;\r\n  email?: string;\r\n  name?: string;\r\n  profileImage?: string | null;\r\n  bannerImage?: string | null;\r\n}\r\n\r\ninterface EditProfilePageClientProps {\r\n  user: User;\r\n}\r\n\r\nexport default function EditProfilePageClient({ user }: Readonly<EditProfilePageClientProps>) {\r\n  const { checkConnectivity, guardedNavigate } = useGuardedNavigate();\r\n  const { update } = useSession();\r\n  const [message, formAction, isPending] = useActionState(\r\n    updateUserProfileAction,\r\n    undefined\r\n  );\r\n\r\n  const initial = useMemo(\r\n    () => ({\r\n      username: user?.username || \"\",\r\n      firstName: user?.firstName || \"\",\r\n      lastName: user?.lastName || \"\",\r\n      email: user?.email || \"\",\r\n      name: user?.name || \"\",\r\n      profileImage: user?.profileImage || null,\r\n      bannerImage: user?.bannerImage || null,\r\n    }),\r\n    [user]\r\n  );\r\n\r\n  const displayName =\r\n    `${initial.firstName} ${initial.lastName}`.trim() ||\r\n    initial.username ||\r\n    initial.name ||\r\n    \"MyAccount\";\r\n\r\n  const [username, setUsername] = useState(initial.username);\r\n  const [firstName, setFirstName] = useState(initial.firstName);\r\n  const [lastName, setLastName] = useState(initial.lastName);\r\n  const [email] = useState(initial.email);\r\n  const [profileImage, setProfileImage] = useState<string | null>(initial.profileImage);\r\n  const [bannerImage, setBannerImage] = useState<string | null>(initial.bannerImage);\r\n  const hasSyncedRef = useRef(false);\r\n\r\n  const { errors, validateImage, validateProfileImages, clearError } =\r\n    useImageValidation();\r\n\r\n  useEffect(() => {\r\n    if (!message || !message.toLowerCase().includes(\"success\")) return;\r\n    if (hasSyncedRef.current) return;\r\n    hasSyncedRef.current = true;\r\n\r\n    const doUpdate = async () => {\r\n      const computedName = `${firstName} ${lastName}`.trim() || username || \"\";\r\n      try {\r\n        await update({\r\n          name: computedName,\r\n          firstName,\r\n          lastName,\r\n          username,\r\n          email,\r\n          profileImage,\r\n          bannerImage,\r\n        });\r\n      } catch (e) {\r\n        console.error(\"Error updating session:\", e);\r\n      }\r\n\r\n      try {\r\n        saveUserSession({\r\n          id: user?.id || \"unknown\",\r\n          email,\r\n          name: computedName,\r\n          firstName,\r\n          lastName,\r\n          username,\r\n          profileImage: profileImage || undefined,\r\n          bannerImage: bannerImage || undefined,\r\n          timestamp: Date.now(),\r\n        });\r\n      } catch (e) {\r\n        console.error(\r\n          \"Error saving local session:\",\r\n          e\r\n        );\r\n      }\r\n\r\n      guardedNavigate(\"/profile\");\r\n    };\r\n\r\n    const t = setTimeout(() => {\r\n      doUpdate();\r\n    }, 200);\r\n    return () => clearTimeout(t);\r\n  }, [\r\n    message,\r\n    firstName,\r\n    lastName,\r\n    username,\r\n    email,\r\n    user?.id,\r\n    update,\r\n    profileImage,\r\n    bannerImage,\r\n    guardedNavigate\r\n  ]);\r\n\r\n  const handleImageChange = (imageType: \"profile\" | \"banner\", value: string | null) => {\r\n    if (imageType === \"profile\") {\r\n      setProfileImage(value);\r\n      if (value) {\r\n        validateImage(value, \"profileImage\");\r\n      } else {\r\n        clearError(\"profileImage\");\r\n      }\r\n    } else if (imageType === \"banner\") {\r\n      setBannerImage(value);\r\n      if (value) {\r\n        validateImage(value, \"bannerImage\");\r\n      } else {\r\n        clearError(\"bannerImage\");\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (formData: FormData) => {\r\n    // Connection check\r\n    const online = await checkConnectivity();\r\n    if (!online) {\r\n      console.log(`[EditProfile] Submission blocked (offline)`);\r\n      return;\r\n    }\r\n    // Validate images before submission\r\n    const profileData = {\r\n      profileImage: profileImage || undefined,\r\n      bannerImage: bannerImage || undefined,\r\n    };\r\n\r\n    const validation = validateProfileImages(profileData);\r\n    if (!validation.isValid) {\r\n      return; // Do not submit if validation fails\r\n    }\r\n\r\n    formData.set(\"username\", username);\r\n    formData.set(\"firstName\", firstName);\r\n    formData.set(\"lastName\", lastName);\r\n    formData.set(\"email\", email);\r\n    if (profileImage) formData.set(\"profileImage\", profileImage);\r\n    if (bannerImage) formData.set(\"bannerImage\", bannerImage);\r\n    startTransition(() => {\r\n      formAction(formData);\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {/* Header with avatar and edit badges like screenshot */}\r\n      <div className=\"flex flex-col items-center md:flex-row md:items-end gap-4 relative z-10\">\r\n        <div className=\"w-24 h-24 md:w-32 md:h-32 rounded-full border-4 border-background overflow-hidden bg-muted ring-2 ring-border/30 shadow-lg\">\r\n          {profileImage ? (\r\n            <img\r\n              src={profileImage}\r\n              alt=\"Profile\"\r\n              className=\"w-full h-full object-cover\"\r\n            />\r\n          ) : (\r\n            <div className=\"w-full h-full bg-primary flex items-center justify-center text-primary-foreground font-bold text-xl\">\r\n              {getInitials(displayName)}\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div className=\"flex-1\" />\r\n      </div>\r\n\r\n      <div className=\"mt-6\">\r\n        <h2 className=\"font-title text-3xl md:text-4xl text-foreground mb-4\">\r\n          Personal Information\r\n        </h2>\r\n\r\n        <Card className=\"px-3 py-6\">\r\n          <form action={handleSubmit} className=\"space-y-4\">\r\n            <Input\r\n              label=\"Username\"\r\n              labelClassName=\"!text-foreground text-xl font-title font-bold\"\r\n              value={username}\r\n              onChange={(e) => setUsername(e.target.value)}\r\n              placeholder=\"Username\"\r\n              className=\"bg-card !text-foreground border-0 border-b border-border rounded-none pl-0 pt-0\"\r\n              noFocusRing\r\n              endAdornment={<Icon name=\"pencil\" className=\"w-4 h-4\" />}\r\n            />\r\n            <Input\r\n              label=\"Last Name\"\r\n              labelClassName=\"!text-foreground text-xl font-title font-bold\"\r\n              value={lastName}\r\n              onChange={(e) => setLastName(e.target.value)}\r\n              placeholder=\"Last Name\"\r\n              className=\"bg-card !text-foreground border-0 border-b border-border rounded-none pl-0 pt-0\"\r\n              noFocusRing\r\n              endAdornment={<Icon name=\"pencil\" className=\"w-4 h-4\" />}\r\n            />\r\n            <Input\r\n              label=\"First Name\"\r\n              labelClassName=\"!text-foreground text-xl font-title font-bold\"\r\n              value={firstName}\r\n              onChange={(e) => setFirstName(e.target.value)}\r\n              placeholder=\"First Name\"\r\n              className=\"bg-card !text-foreground border-0 border-b border-border rounded-none pl-0 pt-0\"\r\n              noFocusRing\r\n              endAdornment={<Icon name=\"pencil\" className=\"w-4 h-4\" />}\r\n            />\r\n\r\n            {/* Image fields */}\r\n            <div className=\"space-y-6\">\r\n              <ImageUpload\r\n                label=\"Profile Picture\"\r\n                value={profileImage}\r\n                onChange={(value) => handleImageChange(\"profile\", value)}\r\n                error={errors.profileImage || undefined}\r\n                className=\"mt-6\"\r\n                accept=\"image/jpeg,image/jpg,image/png,image/gif,image/webp,image/avif\"\r\n                maxSize={10 * 1024 * 1024} // 10MB\r\n                variant=\"input\"\r\n              />\r\n\r\n              <ImageUpload\r\n                label=\"Banner Image\"\r\n                value={bannerImage}\r\n                onChange={(value) => handleImageChange(\"banner\", value)}\r\n                error={errors.bannerImage || undefined}\r\n                className=\"mt-6\"\r\n                accept=\"image/jpeg,image/jpg,image/png,image/gif,image/webp,image/avif\"\r\n                maxSize={10 * 1024 * 1024} // 10MB\r\n                recommendedSize=\"1200x480 pixels\"\r\n                variant=\"input\"\r\n              />\r\n            </div>\r\n\r\n            {message && (\r\n              <p\r\n                className={`text-sm ${message.toLowerCase().includes(\"success\")\r\n                  ? \"text-primary\"\r\n                  : \"text-destructive\"\r\n                  }`}\r\n              >\r\n                {message}\r\n              </p>\r\n            )}\r\n\r\n            <div className=\"flex justify-center pt-2 gap-4\">\r\n              <Button\r\n                type=\"submit\"\r\n                loading={isPending}\r\n                variant=\"primary\"\r\n                className=\"px-6 py-2\"\r\n              >\r\n                Update\r\n              </Button>\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"secondary\"\r\n                className=\"px-6 py-2\"\r\n                onClick={() => guardedNavigate(\"/profile\")}\r\n              >\r\n                Cancel\r\n              </Button>\r\n            </div>\r\n          </form>\r\n        </Card>\r\n        <div className=\"flex justify-center pt-10 gap-4\">\r\n        <Button variant=\"danger\" className=\"px-6 py-2\" asChild>\r\n            <Link href=\"/profile/delete\">\r\n              Delete Account\r\n            </Link>\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction getInitials(name: string | null): string {\r\n  if (!name) return \"?\";\r\n  const parts = String(name).trim().split(/\\s+/);\r\n  const first = parts[0]?.[0] || \"\";\r\n  const last = parts.length > 1 ? parts[parts.length - 1][0] : \"\";\r\n  return (first + last).toUpperCase() || \"?\";\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\profile\\edit\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\profile\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\profile\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\settings\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\support\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\(main)\\trash\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\admin\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\admin\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\admin\\requests\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\admin\\requests\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\admin\\settings\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\admin\\stats\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\admin\\users\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\admin\\users\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\admin\\requests\\[id]\\reject\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\admin\\requests\\[id]\\resolve\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\admin\\requests\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\admin\\settings\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\admin\\stats\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\admin\\users\\[id]\\admin\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\admin\\users\\[id]\\ban\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\auth\\[...nextauth]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\check-deleted-account\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\confirm-share\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\delete-account\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\invite-share\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\openDoc\\accessList\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\openDoc\\history\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\openDoc\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\openDoc\\share\\delete\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\openDoc\\share\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\openDoc\\shared\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\reactivate-account\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\requests\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\syntheses\\generate\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\syntheses\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\syntheses\\status\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\syntheses\\tokens\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\api\\verify-email\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\auth\\error\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\auth\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\banned\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\banned\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\documents\\[id]\\EditDocumentPageClient.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\documents\\[id]\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\documents\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\documents\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\documents\\local\\[id]\\EditLocalDocumentPageClient.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\documents\\local\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\documents\\local\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\documents\\new\\NewDocumentPageClient.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\documents\\new\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\documents\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\logout\\LogoutPageClient.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\logout\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\logout\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Icon.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\DrawingCanvas.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Editor\\CursorOverlay.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has an unnecessary dependency: 'contentVersion'. Either exclude it or remove the dependency array.","line":258,"column":6,"nodeType":"ArrayExpression","endLine":258,"endColumn":65,"suggestions":[{"desc":"Update the dependencies array to be: [editorRef, remoteCursors, adjustedOffsets]","fix":{"range":[8452,8511],"text":"[editorRef, remoteCursors, adjustedOffsets]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { adjustCursorPositionForTextChange } from \"../../../lib/paper.js/cursorUtils\";\r\n\r\ninterface RemoteCursor {\r\n  clientId: string;\r\n  username: string;\r\n  x: number;\r\n  y: number;\r\n  offset: number;\r\n  lastUpdate: number;\r\n}\r\n\r\ninterface CursorOverlayProps {\r\n  editorRef: React.RefObject<HTMLDivElement | null>;\r\n  remoteCursors: Map<string, RemoteCursor>;\r\n}\r\n\r\n// Generate a color based on the clientId for consistent colors\r\nfunction getColorForClientId(clientId: string): string {\r\n  let hash = 0;\r\n  for (let i = 0; i < clientId.length; i++) {\r\n    hash = clientId.charCodeAt(i) + ((hash << 5) - hash);\r\n  }\r\n  \r\n  // Generate a pastel color\r\n  const hue = Math.abs(hash) % 360;\r\n  return `hsl(${hue}, 70%, 50%)`;\r\n}\r\n\r\n// Calculate the (x, y) position from a text offset in the editor\r\nfunction getPositionFromOffset(editor: HTMLDivElement, offset: number): { x: number; y: number } | null {\r\n  try {\r\n    if (!editor.hasChildNodes() || editor.textContent === '') {\r\n      const editorRect = editor.getBoundingClientRect();\r\n      const computedStyle = window.getComputedStyle(editor);\r\n      const paddingLeft = parseFloat(computedStyle.paddingLeft) || 0;\r\n      const paddingTop = parseFloat(computedStyle.paddingTop) || 0;\r\n      return { x: paddingLeft, y: paddingTop };\r\n    }\r\n\r\n    const range = document.createRange();\r\n    const walker = document.createTreeWalker(\r\n      editor,\r\n      NodeFilter.SHOW_TEXT,\r\n      null\r\n    );\r\n\r\n    let currentOffset = 0;\r\n    let textNode: Node | null = null;\r\n    let nodeOffset = 0;\r\n\r\n    while (walker.nextNode()) {\r\n      const node = walker.currentNode;\r\n      if (node.nodeType === Node.TEXT_NODE && node.textContent) {\r\n        const nodeLength = node.textContent.length;\r\n        if (currentOffset + nodeLength >= offset) {\r\n          textNode = node;\r\n          nodeOffset = offset - currentOffset;\r\n          break;\r\n        }\r\n        currentOffset += nodeLength;\r\n      }\r\n    }\r\n\r\n    if (!textNode) {\r\n      const allTextNodes: Node[] = [];\r\n      const textWalker = document.createTreeWalker(\r\n        editor,\r\n        NodeFilter.SHOW_TEXT,\r\n        null\r\n      );\r\n      let node: Node | null;\r\n      while ((node = textWalker.nextNode())) {\r\n        allTextNodes.push(node);\r\n      }\r\n      \r\n      if (allTextNodes.length > 0) {\r\n        textNode = allTextNodes[allTextNodes.length - 1];\r\n        nodeOffset = textNode.textContent?.length || 0;\r\n      } else {\r\n        const editorRect = editor.getBoundingClientRect();\r\n        const computedStyle = window.getComputedStyle(editor);\r\n        const paddingLeft = parseFloat(computedStyle.paddingLeft) || 0;\r\n        const paddingTop = parseFloat(computedStyle.paddingTop) || 0;\r\n        return { x: paddingLeft, y: paddingTop + editorRect.height - paddingTop * 2 };\r\n      }\r\n    }\r\n\r\n    if (textNode && textNode.textContent !== null) {\r\n      const safeOffset = Math.min(Math.max(0, nodeOffset), textNode.textContent.length);\r\n      \r\n      range.setStart(textNode, safeOffset);\r\n      range.setEnd(textNode, safeOffset);\r\n\r\n      const rect = range.getBoundingClientRect();\r\n      const editorRect = editor.getBoundingClientRect();\r\n\r\n      let x = rect.left - editorRect.left;\r\n      let y = rect.top - editorRect.top;\r\n\r\n      if (rect.width === 0 || rect.height === 0) {\r\n        try {\r\n          const tempSpan = document.createElement('span');\r\n          tempSpan.textContent = '\\u200b';\r\n          tempSpan.style.position = 'absolute';\r\n          tempSpan.style.visibility = 'hidden';\r\n          range.insertNode(tempSpan);\r\n          const tempRect = tempSpan.getBoundingClientRect();\r\n          x = tempRect.left - editorRect.left;\r\n          y = tempRect.top - editorRect.top;\r\n          tempSpan.remove();\r\n        } catch (e) {\r\n          // Fallback: use a range to get the position of the text node\r\n          const fallbackRange = document.createRange();\r\n          fallbackRange.selectNodeContents(textNode);\r\n          const nodeRect = fallbackRange.getBoundingClientRect();\r\n          x = nodeRect.left - editorRect.left;\r\n          y = nodeRect.top - editorRect.top;\r\n        }\r\n      }\r\n\r\n      return { x, y };\r\n    }\r\n  } catch (e) {\r\n    console.error('Error calculating cursor position:', e);\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nexport default function CursorOverlay({ editorRef, remoteCursors }: CursorOverlayProps) {\r\n  const [contentVersion, setContentVersion] = useState(0);\r\n  const [hoveredCursor, setHoveredCursor] = useState<string | null>(null);\r\n  const previousTextRef = useRef<string | null>(null);\r\n\r\n  // Client-side adjusted offsets to account for local changes\r\n  // (the original Map is not modified to remain pure)\r\n  const [adjustedOffsets, setAdjustedOffsets] = useState<Map<string, number>>(\r\n    () => new Map()\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!editorRef.current) return;\r\n\r\n    const editor = editorRef.current;\r\n    let timeoutId: NodeJS.Timeout | null = null;\r\n    \r\n    const observer = new MutationObserver(() => {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId);\r\n      }\r\n      timeoutId = setTimeout(() => {\r\n        setContentVersion(prev => prev + 1);\r\n      }, 50);\r\n    });\r\n\r\n    observer.observe(editor, {\r\n      childList: true,\r\n      subtree: true,\r\n      characterData: true,\r\n    });\r\n\r\n    return () => {\r\n      observer.disconnect();\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId);\r\n      }\r\n    };\r\n  }, [editorRef]);\r\n\r\n    // Adjust remote cursor offsets when the editor's text content changes.\r\n    // This allows the position to follow correctly in our view if WE insert/delete text before a remote cursor.\r\n    useEffect(() => {\r\n      if (!editorRef.current) return;\r\n  \r\n      const editor = editorRef.current;\r\n      const newText = editor.textContent || \"\";\r\n      const oldText =\r\n        previousTextRef.current !== null ? previousTextRef.current : newText;\r\n  \r\n      // First initialization: just record the current text\r\n      if (previousTextRef.current === null) {\r\n        previousTextRef.current = newText;\r\n        // Initialize offsets with those received from the server\r\n        setAdjustedOffsets(() => {\r\n          const initial = new Map<string, number>();\r\n          remoteCursors.forEach((cursor) => {\r\n            initial.set(cursor.clientId, cursor.offset);\r\n          });\r\n          return initial;\r\n        });\r\n        return;\r\n      }\r\n  \r\n      // If the text has not changed but the remoteCursors have changed,\r\n      // we simply synchronize the offsets with those received from the server.\r\n      // This avoids keeping an obsolete adjusted offset when the other\r\n      // user moves their cursor without modifying the text.\r\n      if (oldText === newText) {\r\n        setAdjustedOffsets(() => {\r\n          const synced = new Map<string, number>();\r\n          remoteCursors.forEach((cursor) => {\r\n            synced.set(cursor.clientId, cursor.offset);\r\n          });\r\n          return synced;\r\n        });\r\n        return;\r\n      }\r\n  \r\n      // Adjust all cursors based on the oldText ÔåÆ newText difference\r\n    setAdjustedOffsets((prev) => {\r\n      const updated = new Map<string, number>();\r\n\r\n      remoteCursors.forEach((cursor) => {\r\n        const previousOffset = prev.has(cursor.clientId)\r\n          ? (prev.get(cursor.clientId) as number)\r\n          : cursor.offset;\r\n\r\n        const newOffset = adjustCursorPositionForTextChange(\r\n          oldText,\r\n          newText,\r\n          previousOffset\r\n        );\r\n\r\n        updated.set(cursor.clientId, newOffset);\r\n      });\r\n\r\n      return updated;\r\n    });\r\n\r\n    previousTextRef.current = newText;\r\n  }, [contentVersion, editorRef, remoteCursors]);\r\n\r\n  const cursorsWithPositions = useMemo(() => {\r\n    if (!editorRef.current || remoteCursors.size === 0) {\r\n      return [];\r\n    }\r\n\r\n    const editor = editorRef.current;\r\n    const result: Array<{\r\n      cursor: RemoteCursor;\r\n      position: { x: number; y: number } | null;\r\n      color: string;\r\n    }> = [];\r\n\r\n    remoteCursors.forEach((cursor) => {\r\n      const effectiveOffset =\r\n        adjustedOffsets.get(cursor.clientId) ?? cursor.offset;\r\n      const position = editor\r\n        ? getPositionFromOffset(editor, effectiveOffset)\r\n        : null;\r\n      const color = getColorForClientId(cursor.clientId);\r\n      result.push({ cursor, position, color });\r\n    });\r\n\r\n    return result;\r\n  }, [editorRef, remoteCursors, contentVersion, adjustedOffsets]);\r\n\r\n  if (!editorRef.current || cursorsWithPositions.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"absolute inset-0 pointer-events-none z-40\">\r\n      {cursorsWithPositions.map(({ cursor, position, color }) => {\r\n        if (!position) {\r\n          return null;\r\n        }\r\n\r\n        const isHovered = hoveredCursor === cursor.clientId;\r\n\r\n        return (\r\n          <div\r\n            key={cursor.clientId}\r\n            className=\"absolute z-50\"\r\n            style={{\r\n              left: `${position.x}px`,\r\n              top: `${position.y}px`,\r\n              pointerEvents: 'auto',\r\n            }}\r\n            onMouseEnter={() => setHoveredCursor(cursor.clientId)}\r\n            onMouseLeave={() => setHoveredCursor(null)}\r\n          >\r\n            {/* Username above - only shown on hover */}\r\n            {isHovered && (\r\n              <div\r\n                className=\"absolute bottom-full mb-1 px-2 py-1 rounded text-xs font-medium text-white whitespace-nowrap shadow-lg pointer-events-none\"\r\n                style={{\r\n                  backgroundColor: color,\r\n                  transform: 'translateX(-50%)',\r\n                  left: '50%',\r\n                }}\r\n              >\r\n                {cursor.username || 'User'}\r\n              </div>\r\n            )}\r\n            \r\n            {/* Barre verticale du curseur */}\r\n            <div\r\n              className=\"w-0.5 h-5 pointer-events-none\"\r\n              style={{\r\n                backgroundColor: color,\r\n                boxShadow: `0 0 4px ${color}`,\r\n              }}\r\n            />\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Editor\\DebugPanel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Editor\\EditorEffects.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Editor\\EditorEventHandlers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Editor\\ExportOverlay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Editor\\FormattingHandler.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Editor\\ImageOverlay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Editor\\LinkPopup.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Editor\\MarkdownConverter.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Editor\\WysiwygEditor.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'content' and 'undoRedoHistory'. Either include them or remove the dependency array.","line":102,"column":6,"nodeType":"ArrayExpression","endLine":102,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [content, undoRedoHistory]","fix":{"range":[3525,3527],"text":"[content, undoRedoHistory]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Editor\\WysiwygEditorStyles.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Editor\\useUndoRedoHistory.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\AlignmentMenu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\ClientOnlyDrawingCanvas.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\ColorPickers.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\DrawingModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\FileUploadButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\FormatButtons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\HeadingMenu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\ImageEditModal.tsx","messages":[],"suppressedMessages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":174,"column":15,"nodeType":"JSXOpeningElement","endLine":180,"endColumn":17,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\IndentButtons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\ListMenu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\MediaButtons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\QuoteButtons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\ToolbarPopin.tsx","messages":[],"suppressedMessages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":74,"column":41,"nodeType":"JSXOpeningElement","endLine":90,"endColumn":43,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\ToolbarSeparator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\UndoRedoButtons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\Toolbar\\WysiwygToolbar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\Paper.js\\WysiwygNotepad.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\admin\\AdminButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\admin\\AdminGuard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\admin\\AdminNavigation.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\admin\\PromoteAdminButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\admin\\RequestDetailPageClient.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\admin\\RequestsTable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\admin\\StatCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\admin\\StatChartSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\admin\\StatsChart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\admin\\StatsContent.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\admin\\StatsFilter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\admin\\UsersTable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\auth\\BannedUserModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\auth\\GoogleSignInButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\auth\\LoginRequiredModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\auth\\SessionProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\auth\\UserStatusGuard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\common\\ColorPicker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\common\\ConnectionWarning.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\common\\ContentWrapper.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\common\\DynamicFavicon.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\common\\OfflinePopin.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\common\\ThemeToggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\common\\notifications\\NotificationOverlay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\documents\\CommentsSidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\documents\\CreateNoteForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\documents\\DocumentCard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'document'. Either include it or remove the dependency array. If 'setIsFavorite' needs the current value of 'document', you can also switch to useReducer instead of useState and read 'document' in the reducer.","line":130,"column":6,"nodeType":"ArrayExpression","endLine":130,"endColumn":37,"suggestions":[{"desc":"Update the dependencies array to be: [document]","fix":{"range":[4579,4610],"text":"[document]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":130,"column":7,"nodeType":"MemberExpression","endLine":130,"endColumn":36},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'document'. Either include it or remove the dependency array. If 'setPreviewHtml' needs the current value of 'document', you can also switch to useReducer instead of useState and read 'document' in the reducer.","line":180,"column":6,"nodeType":"ArrayExpression","endLine":180,"endColumn":67,"suggestions":[{"desc":"Update the dependencies array to be: [contentIsHtml, document, normalizedString]","fix":{"range":[6790,6851],"text":"[contentIsHtml, document, normalizedString]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":180,"column":7,"nodeType":"ChainExpression","endLine":180,"endColumn":33},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'document'. Either include it or remove the dependency array.","line":193,"column":6,"nodeType":"ArrayExpression","endLine":193,"endColumn":28,"suggestions":[{"desc":"Update the dependencies array to be: [document]","fix":{"range":[7248,7270],"text":"[document]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":193,"column":7,"nodeType":"MemberExpression","endLine":193,"endColumn":27},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'document'. Either include it or remove the dependency array. If 'setTags' needs the current value of 'document', you can also switch to useReducer instead of useState and read 'document' in the reducer.","line":204,"column":6,"nodeType":"ArrayExpression","endLine":204,"endColumn":52,"suggestions":[{"desc":"Update the dependencies array to be: [document]","fix":{"range":[7707,7753],"text":"[document]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":204,"column":7,"nodeType":"MemberExpression","endLine":204,"endColumn":27},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":204,"column":29,"nodeType":"MemberExpression","endLine":204,"endColumn":51},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'document'. Either include it or remove the dependency array.","line":212,"column":6,"nodeType":"ArrayExpression","endLine":212,"endColumn":34,"suggestions":[{"desc":"Update the dependencies array to be: [document, tags]","fix":{"range":[8038,8066],"text":"[document, tags]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":212,"column":13,"nodeType":"MemberExpression","endLine":212,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { useActionState, startTransition } from \"react\";\r\nimport { deleteDocumentAction, updateDocumentAction, toggleFavoriteAction } from \"@/lib/actions\";\r\nimport Link from \"next/link\";\r\nimport { Button, Input } from \"@/components/ui\";\r\nimport { useGuardedNavigate } from \"@/hooks/useGuardedNavigate\";\r\nimport Modal from \"@/components/ui/modal\";\r\nimport TagsManager from \"@/components/documents/TagsManager\";\r\nimport LoginRequiredModal from \"@/components/auth/LoginRequiredModal\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { Document, LocalDocument, AnyDocument } from \"@/lib/types\";\r\nimport { Avatar, AvatarImage, AvatarFallback } from \"@/components/ui\";\r\nimport FavoriteToggle from \"@/components/documents/FavoriteToggle\";\r\nimport sanitizeLinks from \"@/lib/sanitizeLinks\";\r\nimport { sanitizeHtml, PREVIEW_SANITIZE_CONFIG } from \"@/lib/sanitizeHtml\";\r\nimport Icon from \"@/components/Icon\";\r\n\r\ninterface DocumentCardProps {\r\n  document: AnyDocument;\r\n  currentUserId?: string | number | null;\r\n  onDelete?: (id: string | number) => void;\r\n  selectMode?: boolean;\r\n  selected?: boolean;\r\n  onToggleSelect?: (id: string | number, checked: boolean) => void;\r\n  onEnterSelectMode?: (id: string | number) => void;\r\n  isLocal?: boolean;\r\n  index?: number;\r\n  onFavoriteChange?: (id: string | number, isFavorite: boolean) => void;\r\n}\r\n\r\nfunction unwrapToString(raw: any): string {\r\n  try {\r\n    let cur = raw;\r\n    let safety = 0;\r\n    while (safety < 50) {\r\n      safety++;\r\n      if (typeof cur === \"string\") {\r\n        try {\r\n          const parsed = JSON.parse(cur);\r\n          cur = parsed;\r\n          continue;\r\n        } catch (e) {\r\n          return stripHtml(cur);\r\n        }\r\n      }\r\n      if (cur && typeof cur === \"object\" && \"text\" in cur) {\r\n        cur = (cur as any).text;\r\n        continue;\r\n      }\r\n      if (cur && typeof cur === \"object\") {\r\n        for (const k of Object.keys(cur)) {\r\n          if (typeof (cur as any)[k] === \"string\") return stripHtml((cur as any)[k]);\r\n          if (\r\n            (cur as any)[k] &&\r\n            typeof (cur as any)[k] === \"object\" &&\r\n            \"text\" in (cur as any)[k] &&\r\n            typeof (cur as any)[k].text === \"string\"\r\n          ) {\r\n            return stripHtml((cur as any)[k].text);\r\n          }\r\n        }\r\n        return JSON.stringify(cur);\r\n      }\r\n      return String(cur ?? \"\");\r\n    }\r\n    return String(raw ?? \"\");\r\n  } catch (e) {\r\n    return String(raw ?? \"\");\r\n  }\r\n}\r\n\r\nfunction detectHtmlInString(str: string): boolean {\r\n  if (!str || typeof str !== \"string\") return false;\r\n  try {\r\n    const doc = new DOMParser().parseFromString(str, \"text/html\");\r\n    return Array.from(doc.body.childNodes).some((n) => n.nodeType === 1);\r\n  } catch (e) {\r\n    return /<\\/?[a-z][\\s\\S]*>/i.test(str);\r\n  }\r\n}\r\n\r\nfunction stripHtml(str: string): string {\r\n  if (!str || typeof str !== \"string\") return \"\";\r\n  return str.replace(/<\\/?[^>]+(>|$)/g, \"\");\r\n}\r\n\r\nexport default function DocumentCard({\r\n  document,\r\n  currentUserId,\r\n  onDelete,\r\n  selectMode = false,\r\n  selected = false,\r\n  onToggleSelect = () => {},\r\n  onEnterSelectMode = () => {},\r\n  isLocal = false,\r\n  index = 0,\r\n  onFavoriteChange,\r\n}: DocumentCardProps) {\r\n  const [message, formAction, isPending] = useActionState(\r\n    deleteDocumentAction,\r\n    undefined\r\n  );\r\n  const [updateMsg, updateFormAction, isUpdating] = useActionState(\r\n    updateDocumentAction,\r\n    { ok: false, error: \"\" }\r\n  );\r\n  const [favMsg, favFormAction, isFavUpdating] = useActionState(\r\n    toggleFavoriteAction,\r\n    undefined\r\n  );\r\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\r\n  const [isHovered, setIsHovered] = useState(false);\r\n  const { checkConnectivity } = useGuardedNavigate();\r\n  const [showLoginModal, setShowLoginModal] = useState(false);\r\n\r\n  const isOwner = ('user_id' in document) ? (document as any).user_id === currentUserId : false;\r\n  const updatedDate = new Date((document as any).updated_at || new Date());\r\n  const [accessList, setAccessList] = useState<any[]>([]);\r\n  // Normalize is_favorite which can come from different sources (document.is_favorite or Share.is_favorite)\r\n  // and may be truthy but not strictly `true` in some codepaths. Keep local state\r\n  // synchronized when the prop changes.\r\n  const [isFavorite, setIsFavorite] = useState<boolean>(Boolean((document as any).is_favorite));\r\n  useEffect(() => {\r\n    try {\r\n      setIsFavorite(Boolean((document as any).is_favorite));\r\n    } catch (e) {\r\n      // ignore\r\n    }\r\n  }, [(document as any).is_favorite]);\r\n  const formattedDate = updatedDate.toLocaleDateString(\"en-US\", { day: \"2-digit\", month: \"2-digit\", year: \"numeric\" });\r\n  const updatedAtIso = (\r\n    typeof (document as any).updated_at === 'string'\r\n      ? (document as any).updated_at\r\n      : new Date((document as any).updated_at || Date.now()).toISOString()\r\n  );\r\n\r\n  const getContentText = (content: any): string => {\r\n    try {\r\n      if (typeof content === \"string\") {\r\n        const parsed = JSON.parse(content);\r\n        if (parsed && typeof parsed === \"object\" && \"text\" in parsed) { return parsed.text || \"\"; }\r\n        return content;\r\n      }\r\n      if (typeof content === \"object\" && content !== null) { return (content as any).text || \"\"; }\r\n      return content || \"\";\r\n    } catch (e) { return content || \"\"; }\r\n  };\r\n  const contentText = getContentText((document as any).content);\r\n  const contentTextSanitized = sanitizeLinks(contentText);\r\n  const cleanText = (text: string): string => text\r\n      .replace(/\\*\\*(.*?)\\*\\*/g, '$1')\r\n      .replace(/\\*(.*?)\\*/g, '$1')\r\n      .replace(/<u>(.*?)<\\/u>/g, '$1')\r\n      .replace(/~~(.*?)~~/g, '$1')\r\n      .replace(/<span[^>]*>(.*?)<\\/span>/g, '$1')\r\n      .replace(/#+\\s*/g, '')\r\n      .replace(/<\\/?[^>]+(>|$)/g, '')\r\n      .trim();\r\n  const firstLine = cleanText((contentTextSanitized || \"\").substring(0, 500).split(/\\n\\n/)[0]);\r\n  const isEmpty = !contentText || contentText.trim() === \"\" || !firstLine || firstLine.trim() === \"\";\r\n  const rawPreviewSource = sanitizeLinks(getContentText((document as any)?.content));\r\n  const normalizedString = unwrapToString(rawPreviewSource);\r\n  const contentIsHtml = detectHtmlInString(normalizedString);\r\n  const previewText = contentIsHtml ? stripHtml(normalizedString) : normalizedString;\r\n  const [previewHtml, setPreviewHtml] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (!contentIsHtml) {\r\n      setPreviewHtml(\"\");\r\n      return;\r\n    }\r\n    try {\r\n      const safe = sanitizeHtml(normalizedString, PREVIEW_SANITIZE_CONFIG);\r\n      setPreviewHtml(safe);\r\n    } catch (e) {\r\n      console.warn(\"DOMPurify sanitize failed\", e);\r\n      setPreviewHtml(stripHtml((document as any)?.content || \"\"));\r\n    }\r\n  }, [(document as any)?.content, contentIsHtml, normalizedString]);\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    (async () => {\r\n      try {\r\n        const res = await fetch(`/api/openDoc/accessList?id=${(document as any).id}`);\r\n        const data = await res.json();\r\n        const list = data?.accessList || [];\r\n        if (data?.success && mounted) setAccessList(list);\r\n      } catch (e) {}\r\n    })();\r\n    return () => { mounted = false; };\r\n  }, [(document as any).id]);\r\n\r\n  const [tags, setTags] = useState<string[]>([]);\r\n  useEffect(() => {\r\n    if (Array.isArray((document as any).tags)) { setTags((document as any).tags); return; }\r\n    try {\r\n      const raw = localStorage.getItem(\"notus.tags\");\r\n      const parsed = raw ? JSON.parse(raw) : {};\r\n      const existing = parsed?.[String((document as any).id)] || [];\r\n      if (Array.isArray(existing)) setTags(existing);\r\n    } catch (_) {}\r\n  }, [(document as any).id, (document as any).tags]);\r\n  useEffect(() => {\r\n    try {\r\n      const raw = localStorage.getItem(\"notus.tags\");\r\n      const parsed = raw ? JSON.parse(raw) : {};\r\n      parsed[String((document as any).id)] = tags;\r\n      localStorage.setItem(\"notus.tags\", JSON.stringify(parsed));\r\n    } catch (_) {}\r\n  }, [tags, (document as any).id]);\r\n\r\n  const persistTags = (nextTags: string[]) => {\r\n    if (!currentUserId) return;\r\n    const fd = new FormData();\r\n    fd.append(\"documentId\", String((document as any).id));\r\n    fd.append(\"userId\", String(currentUserId));\r\n    fd.append(\"title\", (document as any).title || \"Untitled\");\r\n    fd.append(\"content\", (document as any).content || \"\");\r\n    fd.append(\"tags\", JSON.stringify(nextTags));\r\n    startTransition(() => { updateFormAction(fd); });\r\n  };\r\n\r\n  const handleTagsChange = async (newTags: string[]) => {\r\n    const prevTags = tags || [];\r\n    const isAddition = newTags.length > prevTags.length;\r\n    const isRemoval = newTags.length < prevTags.length;\r\n    if (isAddition) {\r\n      if (!currentUserId) {\r\n        window.dispatchEvent(new CustomEvent(\"notus:offline-popin\", { detail: { message: \"You will be able to access this feature once connectivity is restored.\", durationMs: 5000 } }));\r\n        return;\r\n      }\r\n      const online = await checkConnectivity();\r\n      if (!online) {\r\n        window.dispatchEvent(new CustomEvent(\"notus:offline-popin\", { detail: { message: \"You will be able to access this feature once connectivity is restored.\", durationMs: 5000 } }));\r\n        return;\r\n      }\r\n      setTags(newTags);\r\n      persistTags(newTags);\r\n      return;\r\n    }\r\n    if (isRemoval) {\r\n      setTags(newTags);\r\n      if (!currentUserId) return;\r\n      const online = await checkConnectivity();\r\n      if (online) { persistTags(newTags); }\r\n      else { window.dispatchEvent(new CustomEvent(\"notus:offline-popin\", { detail: { message: \"You will be able to access this feature once connectivity is restored.\", durationMs: 5000 } })); }\r\n      return;\r\n    }\r\n  };\r\n\r\n  const handleTagsClick = () => { if (!currentUserId) { setShowLoginModal(true); } };\r\n\r\n  const handleDelete = (formData: FormData) => {\r\n    if (!currentUserId) return;\r\n    formData.append(\"documentId\", String((document as any).id));\r\n    formData.append(\"userId\", String(currentUserId));\r\n    startTransition(() => { formAction(formData); });\r\n    setShowDeleteConfirm(false);\r\n    if (onDelete) { onDelete((document as any).id); }\r\n  };\r\n\r\n  const applyFavoriteChange = async (next: boolean) => {\r\n    if (!currentUserId) { setShowLoginModal(true); return; }\r\n    try {\r\n      const fd = new FormData();\r\n      fd.append(\"documentId\", String((document as any).id));\r\n      fd.append(\"value\", next ? \"1\" : \"\");\r\n      startTransition(() => { favFormAction(fd); });\r\n      setIsFavorite(next);\r\n      try { onFavoriteChange && onFavoriteChange((document as any).id, next); } catch (_) {}\r\n    } catch (_) {}\r\n  };\r\n\r\n  const longPressTimerRef = useRef<NodeJS.Timeout | null>(null);\r\n  const longPressActivatedRef = useRef(false);\r\n  const clearLongPressTimer = () => { if (longPressTimerRef.current) { clearTimeout(longPressTimerRef.current); longPressTimerRef.current = null; } };\r\n  const startLongPressTimer = () => {\r\n    if (selectMode) {\r\n      clearLongPressTimer();\r\n      return;\r\n    }\r\n    clearLongPressTimer();\r\n    longPressActivatedRef.current = false;\r\n    longPressTimerRef.current = setTimeout(() => {\r\n      longPressActivatedRef.current = true;\r\n      onEnterSelectMode((document as any).id);\r\n      onToggleSelect((document as any).id, true);\r\n    }, 500);\r\n  };\r\n  const handleLongPress = () => {\r\n    if (selectMode || longPressActivatedRef.current) return;\r\n    onEnterSelectMode((document as any).id);\r\n    onToggleSelect((document as any).id, !selected);\r\n  };\r\n\r\n  const previewRef = useRef<HTMLDivElement>(null);\r\n  const [computedStyle, setComputedStyle] = useState({ color: null as string | null, backgroundColor: null as string | null, fontSize: null as string | null, fontFamily: null as string | null, fontWeight: null as string | null, lineHeight: null as string | null, accent: null as string | null });\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\") return;\r\n    const el = previewRef.current;\r\n    const target = el instanceof Element ? el : ((window as any).document as any).body;\r\n    try {\r\n      const style = window.getComputedStyle(target);\r\n      setComputedStyle({ color: style.color, backgroundColor: style.backgroundColor, fontSize: style.fontSize, fontFamily: style.fontFamily, fontWeight: style.fontWeight, lineHeight: style.lineHeight, accent: style.getPropertyValue(\"--accent-color\") || null, });\r\n    } catch (e) { setComputedStyle((s) => s); }\r\n  }, [previewHtml, previewText]);\r\n\r\n  const documentUrl = isLocal ? `/documents/local/${encodeURIComponent(String((document as any).id))}` : `/documents/${(document as any).id}`;\r\n  const handleCardNavigation = async (e: React.MouseEvent) => {\r\n    if (showLoginModal) { e.preventDefault(); e.stopPropagation(); return; }\r\n    if (longPressActivatedRef.current) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      longPressActivatedRef.current = false;\r\n      return;\r\n    }\r\n    if (selectMode) { e.preventDefault(); e.stopPropagation(); onToggleSelect((document as any).id, !selected); return; }\r\n    e.preventDefault();\r\n    try {\r\n      const controller = new AbortController();\r\n      const timeoutId = window.setTimeout(() => controller.abort(), 5000);\r\n      const resp = await fetch(\"/api/admin/check-status\", { method: \"GET\", cache: \"no-store\", credentials: \"include\", headers: { \"cache-control\": \"no-cache\" }, signal: controller.signal });\r\n      window.clearTimeout(timeoutId);\r\n      if (resp.ok) { window.location.href = documentUrl; }\r\n    } catch (err: any) {\r\n      window.dispatchEvent(new CustomEvent(\"notus:offline-popin\", { detail: { message: \"You will be able to access this feature once connectivity is restored.\", durationMs: 5000 } }));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <article\r\n      className={cn(\r\n        \"group relative bg-card border rounded-xl p-5 transition-all duration-300 hover:shadow-lg hover:shadow-primary/5 hover:-translate-y-1 animate-fade-in-up cursor-pointer\",\r\n        selected && \"border-primary ring-2 ring-primary/20 bg-primary/5\",\r\n      )}\r\n      style={{ animationDelay: `${index * 50}ms` }}\r\n      onMouseEnter={() => setIsHovered(true)}\r\n      onMouseLeave={() => { setIsHovered(false); clearLongPressTimer(); }}\r\n      onContextMenu={(e) => { e.preventDefault(); handleLongPress(); }}\r\n      onMouseDown={startLongPressTimer}\r\n      onMouseUp={clearLongPressTimer}\r\n      onTouchStart={startLongPressTimer}\r\n      onTouchEnd={clearLongPressTimer}\r\n      onClick={handleCardNavigation}\r\n    >\r\n      <header className=\"relative flex items-start justify-between mb-3 min-h-[2.5rem]\">\r\n        <div className=\"absolute inset-0 left-0 right-12 flex items-center gap-2 pointer-events-none\">\r\n          <div \r\n            className=\"flex-1 min-w-0 max-w-full pointer-events-auto\" \r\n            onClick={(e) => { if (selectMode) { return; } e.preventDefault(); e.stopPropagation(); handleTagsClick(); }}\r\n            onMouseDown={(e) => { e.stopPropagation(); }}\r\n            onMouseUp={(e) => { e.stopPropagation(); }}\r\n            onTouchStart={(e) => { e.stopPropagation(); }}\r\n            onTouchEnd={(e) => { e.stopPropagation(); }}\r\n            onWheel={(e) => { e.stopPropagation(); }}\r\n          >\r\n            <TagsManager tags={tags} onTagsChange={handleTagsChange} placeholder=\"New tag...\" maxTags={10} disabled={!currentUserId || selectMode} />\r\n          </div>\r\n        </div>\r\n        {!selectMode && (\r\n          <div className=\"relative z-10 ml-auto\">\r\n            <FavoriteToggle isFavorite={isFavorite} isAuthenticated={Boolean(currentUserId)} onToggleAuthenticated={applyFavoriteChange} onRequireLogin={() => setShowLoginModal(true)} />\r\n          </div>\r\n        )}\r\n      </header>\r\n      <section className=\"space-y-2\">\r\n        <h3 className=\"text-lg font-semibold text-card-foreground group-hover:text-primary transition-colors duration-200\">{(document as any).title}</h3>\r\n        <div ref={previewRef} className=\"text-sm text-muted-foreground line-clamp-1 leading-relaxed\">\r\n          {contentIsHtml ? (\r\n            previewHtml ? (\r\n              <div className=\"prose max-w-full\" dangerouslySetInnerHTML={{ __html: previewHtml }} />\r\n            ) : (\r\n              <p className=\"text-muted-foreground/70 italic\">Loading...</p>\r\n            )\r\n          ) : (\r\n            !isEmpty ? (\r\n              <p className=\"text-muted-foreground\">{firstLine}</p>\r\n            ) : (\r\n              <p className=\"text-muted-foreground italic\">Empty document</p>\r\n            )\r\n          )}\r\n        </div>\r\n      </section>\r\n      <footer className=\"mt-4 pt-3 border-t border-border flex items-center justify-between\">\r\n        <time dateTime={updatedAtIso} className=\"text-xs text-muted-foreground\">{formattedDate}</time>\r\n        {currentUserId && !selectMode && (\r\n          <div className=\"flex items-center ml-3\">\r\n            <div className=\"flex -space-x-2\">\r\n              {accessList.map((u, i) => (\r\n                <div key={u.email || u.id || i} className=\"inline-block\">\r\n                  <Avatar title={u.username || (u.first_name ?? \"\")}>\r\n                    <AvatarImage src={u.profile_image ?? undefined} alt={`${u.first_name ?? \"\"} ${u.last_name ?? \"\"}`} loading=\"lazy\" />\r\n                    <AvatarFallback className=\"text-xs\">{((u.first_name || u.username || \"U\") as string).charAt(0).toUpperCase()}</AvatarFallback>\r\n                  </Avatar>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {selectMode && (\r\n          <div onClick={(e) => { e.preventDefault(); e.stopPropagation(); onToggleSelect((document as any).id, !selected); }} className={cn(\"h-5 w-5 border-2 rounded transition-all duration-200 cursor-pointer flex items-center justify-center animate-fade-in\", selected ? \"border-primary bg-primary\" : \"border-input bg-background\")} role=\"checkbox\" aria-checked={selected} aria-label=\"Select this document\">\r\n            {selected && (<Icon name=\"check\" className=\"w-4 h-4 text-primary-foreground\" />)}\r\n          </div>\r\n        )}\r\n      </footer>\r\n      {message && (\r\n        <div className=\"mt-4 p-3 bg-destructive/10 border border-destructive/20 rounded-lg\"><p className=\"text-sm text-destructive\">{message}</p></div>\r\n      )}\r\n      <LoginRequiredModal isOpen={showLoginModal} onClose={() => setShowLoginModal(false)} message=\"You must be logged in to manage this document's tags.\" />\r\n    </article>\r\n  );\r\n}\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\documents\\DocumentsGridClient.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\documents\\FavoriteToggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\documents\\FloatingCreateButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\documents\\HistorySidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\documents\\NoteCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\documents\\NotesFilterModal.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'availableTags.length', 'fetchFolders', 'fetchTags', 'hasLoadedFolders', 'isLoadingFolders', and 'isLoadingTags'. Either include them or remove the dependency array.","line":72,"column":6,"nodeType":"ArrayExpression","endLine":72,"endColumn":53,"suggestions":[{"desc":"Update the dependencies array to be: [isOpen, filters, isAuthenticated, contextTags, hasLoadedFolders, isLoadingFolders, availableTags.length, isLoadingTags, fetchFolders, fetchTags]","fix":{"range":[2647,2694],"text":"[isOpen, filters, isAuthenticated, contextTags, hasLoadedFolders, isLoadingFolders, availableTags.length, isLoadingTags, fetchFolders, fetchTags]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\documents\\SearchableDocumentsList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\documents\\SelectionBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\documents\\SynthesisSidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\documents\\TagsManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\landing\\CTASection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\landing\\FeatureGrid.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\landing\\HeroSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\landing\\HowItWorks.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\landing\\LandingFooter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\landing\\LandingHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\landing\\MetricsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\landing\\SectionHeading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\landing\\TestimonialSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\layout\\MainWithSidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\legal\\TableOfContents.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\navigation\\NavBar.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":147,"column":21,"nodeType":"JSXOpeningElement","endLine":147,"endColumn":111},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":224,"column":23,"nodeType":"JSXOpeningElement","endLine":224,"endColumn":113},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":343,"column":23,"nodeType":"JSXOpeningElement","endLine":343,"endColumn":113}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { usePathname, useRouter } from \"next/navigation\";\r\nimport Image  from \"next/image\";\r\nimport { useSession } from \"next-auth/react\";\r\nimport NotificationOverlay from \"@/components/common/notifications/NotificationOverlay\";\r\nimport { Logo, Input, Button } from \"@/components/ui\";\r\nimport Icon, { type IconName } from \"@/components/Icon\";\r\nimport { useLocalSession } from \"@/hooks/useLocalSession\";\r\nimport { useNotification } from \"@/contexts/NotificationContext\";\r\nimport { useSearch } from \"@/contexts/SearchContext\";\r\nimport { useGuardedNavigate } from \"@/hooks/useGuardedNavigate\";\r\nimport LoginRequiredModal from \"@/components/auth/LoginRequiredModal\";\r\nimport BadgeIcon from \"../ui/notifications/badge-icon\";\r\nimport NotesFilterModal from \"@/components/documents/NotesFilterModal\";\r\nimport { getProfileImage, checkAdminStatus } from \"@/actions/userActions\";\r\n\r\ninterface NavItem {\r\n  name: string;\r\n  href: string;\r\n  onClick?: (e: React.MouseEvent) => void;\r\n  icon: IconName;\r\n  mobileHidden?: boolean;\r\n  unreadNotifications?: number;\r\n}\r\n\r\nexport default function NavBar() {\r\n  const pathname = usePathname();\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [showLoginModal, setShowLoginModal] = useState(false);\r\n  const [showNotifications, setShowNotifications] = useState(false);\r\n  const router = useRouter();\r\n  const { searchQuery, startSearch, clearSearch, hasActiveFilters } = useSearch();\r\n  const { data: session, status } = useSession();\r\n  const { logout } = useLocalSession();\r\n  const { guardedNavigate } = useGuardedNavigate();\r\n\r\n  const [mounted, setMounted] = useState(false);\r\n  useEffect(() => { setMounted(true); }, []);\r\n\r\n  const isLoggedIn = status === \"authenticated\" && session?.user;\r\n  const userName = session?.user?.name || (session?.user as any)?.firstName || null;\r\n  const username = (session?.user as any)?.username || null;\r\n  const profileImage = (session?.user as any)?.profileImage || null;\r\n  const [localProfileImage, setLocalProfileImage] = useState<string | null>(profileImage);\r\n  const [showFiltersModal, setShowFiltersModal] = useState(false);\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n  const [adminLoading, setAdminLoading] = useState(true);\r\n  useEffect(() => { setLocalProfileImage(profileImage); }, [profileImage]);\r\n  useEffect(() => {\r\n    const fetchProfileImage = async () => {\r\n      if (isLoggedIn && !profileImage) {\r\n        try {\r\n          const result = await getProfileImage();\r\n          if (result.success && result.profileImage) {\r\n            setLocalProfileImage(result.profileImage);\r\n          }\r\n        } catch {}\r\n      }\r\n    };\r\n    fetchProfileImage();\r\n  }, [isLoggedIn, profileImage]);\r\n\r\n  useEffect(() => {\r\n    const checkAdminStatus = async () => {\r\n      if (!isLoggedIn) {\r\n        setAdminLoading(false);\r\n        return;\r\n      }\r\n      try {\r\n        const result = await checkAdminStatus();\r\n        if (result.success) {\r\n          setIsAdmin(result.isAdmin);\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error verifying admin status:\", error);\r\n      } finally {\r\n        setAdminLoading(false);\r\n      }\r\n    };\r\n\r\n    checkAdminStatus();\r\n  }, [isLoggedIn]);\r\n\r\n  const { unreadCount, refresh } = useNotification();\r\n\r\n  const items: NavItem[] = [\r\n    { name: \"My notes\", href: \"/app\", icon: \"note\" },\r\n    { name: \"Favorites\", href: \"/favorites\", icon: \"star\" },\r\n    { name: \"Folders\", href: \"/folders\", icon: \"folder\" },\r\n    { name: \"Support\", href: \"/support\", icon: \"alert\" },\r\n    { name: \"Notifications\", href: \"#\", icon: \"bell\", onClick: (e) => { e.preventDefault(); handleNotificationOverlay(e); }, mobileHidden: true, unreadNotifications: unreadCount },\r\n    { name: \"Trash\", href: \"/trash\", icon: \"trash\" },\r\n  ];\r\n\r\n  const pageTitle = getPageTitle(pathname, items);\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      if (isLoggedIn) { router.push(\"/logout\"); } else { await guardedNavigate(\"/login\"); }\r\n    } catch {} finally { setIsOpen(false); }\r\n  };\r\n\r\n  const handleDesktopSearchKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n    if (e.key === \"Enter\") {\r\n      const q = searchQuery.trim();\r\n      if (q.length > 0) startSearch(q); else clearSearch();\r\n    }\r\n  };\r\n  const handleSearchChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const value = e.target.value; if (value.length > 0) startSearch(value); else clearSearch();\r\n  };\r\n  const handleNavItemClick = (e: React.MouseEvent, href: string) => {\r\n    e.preventDefault(); setIsOpen(false);\r\n    if ((href === \"/favorites\" || href === \"/trash\" || href === \"/folders\" || href === \"/support\") && !isLoggedIn) { setShowLoginModal(true); return; }\r\n    guardedNavigate(href);\r\n  };\r\n  const handleNotificationOverlay = (e?: React.MouseEvent) => {\r\n    e?.preventDefault?.();\r\n    if (!mounted || !isLoggedIn) { setShowLoginModal(true); return; }\r\n    setShowNotifications((prev) => { const next = !prev; if (next) setIsOpen(false); return next; });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <header className=\"sticky top-0 z-40 bg-background\">\r\n        <div className=\"w-full px-2 h-16 flex items-center justify-between md:hidden\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <button aria-label=\"Open menu\" onClick={() => setIsOpen(!isOpen)} className=\"md:hidden p-2 rounded-md hover:bg-accent/20 text-foreground focus:outline-none focus:ring-2 focus:ring-ring cursor-pointer transition-colors duration-200 ease-in-out\">\r\n              <Icon name=\"menu\" className=\"w-6 h-6\" />\r\n            </button>\r\n            <span className=\"font-title text-2xl sm:text-3xl font-regular text-foreground leading-tight\">{pageTitle}</span>\r\n            <button type=\"button\" className=\"items-center hidden md:flex cursor-pointer\" onClick={() => guardedNavigate(\"/app\")} aria-label=\"Home\">\r\n              <Logo width={160} height={46} />\r\n            </button>\r\n          </div>\r\n          <div className=\"flex items-center gap-2 md:hidden\">\r\n            {mounted && isLoggedIn && (\r\n              <>\r\n                <button aria-label=\"Notifications\" onClick={handleNotificationOverlay} className={`p-2 rounded-md hover:bg-accent/20 text-foreground focus:outline-none focus:ring-2 focus:ring-ring cursor-pointer transition-colors duration-200 ease-in-out ${showNotifications ? 'bg-accent' : ''}`} title=\"Notifications\">\r\n                  <BadgeIcon name=\"bell\" count={unreadCount} />\r\n                </button>\r\n                <button type=\"button\" onClick={() => guardedNavigate(\"/profile\")} aria-label=\"Profile\" className=\"ml-1 inline-flex items-center justify-center w-8 h-8 rounded-full overflow-hidden bg-muted ring-1 ring-border/20 shadow-sm\" title={userName || \"Profile\"}>\r\n                  {localProfileImage ? (\r\n                    <img src={localProfileImage} alt=\"Profile photo\" className=\"w-full h-full object-cover\" />\r\n                  ) : (\r\n                    <div className=\"w-full h-full bg-secondary text-secondary-foreground font-semibold flex items-center justify-center\">{getInitials(userName)}</div>\r\n                  )}\r\n                </button>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      {isOpen && (\r\n        <div className=\"md:hidden fixed inset-0 z-50\">\r\n          <div className=\"absolute inset-0 bg-foreground/30\" onClick={() => setIsOpen(false)} />\r\n          <div className=\"absolute left-0 top-0 h-full w-72 bg-background border-r-2 border-border/50 p-4 flex flex-col\">\r\n            <div className=\"flex items-center justify-end mb-4\">\r\n              <button aria-label=\"Close\" onClick={() => setIsOpen(false)} className=\"p-2 rounded-sm hover:bg-accent/20 text-foreground focus:outline-none focus:ring-2 focus:ring-ring cursor-pointer transition-colors duration-200 ease-in-out\">\r\n                <Icon name=\"x\" className=\"w-6 h-6\" />\r\n              </button>\r\n            </div>\r\n            <nav className=\"space-y-1 flex-1 overflow-y-auto\">\r\n              <div className=\"flex justify-center mb-3 p-3\">\r\n                <button type=\"button\" onClick={() => { setIsOpen(false); guardedNavigate(\"/app\"); }} className=\"inline-flex items-center cursor-pointer\" aria-label=\"Home\">\r\n                  <Logo width={160} height={46} />\r\n                </button>\r\n              </div>\r\n              <div className=\"px-3 mb-3\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Input className=\"flex-1\" placeholder=\"Search...\" value={searchQuery} onChange={handleSearchChange} onKeyDown={handleDesktopSearchKeyDown} />\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => { setShowFiltersModal(true); setIsOpen(false); }}\r\n                    className={`inline-flex items-center justify-center h-10 w-10 rounded-md border border-border transition-colors duration-200 ease-in-out ${hasActiveFilters ? \"bg-primary text-primary-foreground\" : \"text-foreground hover:bg-accent/20\"}`}\r\n                    aria-pressed={hasActiveFilters}\r\n                    aria-label=\"Open filters\"\r\n                    title=\"Filter notes\"\r\n                  >\r\n                    <Icon name=\"filter\" className=\"w-4 h-4\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <div className=\"pt-3\"></div>\r\n              <div className=\"px-2 space-y-2\">\r\n                {items.filter((i) => !i.mobileHidden).map((item) => (\r\n                  item.onClick ? (\r\n                    <button key={item.href} onClick={(e) => { e.preventDefault(); item.onClick?.(e); setIsOpen(false); }} className={`w-full flex items-center gap-2 p-2 rounded-sm hover:bg-accent/20 text-foreground transition-colors duration-200 ease-in-out ${pathname === item.href || (item.name === 'Notifications' && showNotifications) ? 'bg-accent' : ''}`}>\r\n                      <div className=\"relative flex items-center\">\r\n                        {/* show badge only for Notifications item */}\r\n                        <BadgeIcon name={item.icon} count={item.name === \"Notifications\" ? item.unreadNotifications ?? undefined : undefined} className=\"w-5 h-5\" />\r\n                      </div>\r\n                      <span className=\"font-medium text-sm\">{item.name}</span>\r\n                    </button>\r\n                  ) : (\r\n                    <Link key={item.href} href={item.href} onClick={(e) => handleNavItemClick(e, item.href)} className={`flex items-center gap-2 p-3 rounded-sm hover:bg-accent/20 text-foreground transition-colors duration-200 ease-in-out ${pathname === item.href || (item.name === 'Notifications' && showNotifications) ? 'bg-accent' : ''}`}>\r\n                      <div className=\"relative flex items-center\">\r\n                        <BadgeIcon name={item.icon} count={item.name === \"Notifications\" ? item.unreadNotifications ?? undefined : undefined} className=\"w-5 h-5\" />\r\n                      </div>\r\n                      <span className=\"font-medium text-sm\">{item.name}</span>\r\n                    </Link>\r\n                  )\r\n                ))}\r\n              </div>\r\n            </nav>\r\n            <div className=\"pt-4 space-y-3\">\r\n              {mounted && isLoggedIn ? (\r\n                <>\r\n                  <Link\r\n                    href=\"/support\"\r\n                    onClick={(e) => handleNavItemClick(e, \"/support\")}\r\n                    className=\"block text-sm text-muted-foreground hover:text-foreground transition-colors duration-200 ease-in-out\"\r\n                  >\r\n                    Need help?\r\n                  </Link>\r\n              <div className=\"flex items-center gap-3 border-t border-border pt-3\">\r\n                <button type=\"button\" onClick={() => guardedNavigate(\"/profile\")} className=\"flex items-center gap-3 flex-1 bg-transparent cursor-pointer text-left\">\r\n                  <div className=\"flex items-center justify-center w-10 h-10 rounded-full overflow-hidden bg-muted ring-1 ring-border/20 shadow-sm\">\r\n                    {localProfileImage ? (\r\n                      <img src={localProfileImage} alt=\"Profile photo\" className=\"w-full h-full object-cover\" />\r\n                    ) : (\r\n                      <div className=\"w-full h-full bg-secondary text-secondary-foreground font-semibold flex items-center justify-center\">{getInitials(userName || username || \"Anonymous\")}</div>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"flex flex-col\">\r\n                    <span className=\"text-sm font-semibold text-foreground\">{username || userName || \"Anonymous\"}</span>\r\n                  </div>\r\n                </button>\r\n                {!adminLoading && isAdmin && (\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={(e) => { e.preventDefault(); guardedNavigate(\"/admin\"); }}\r\n                    className=\"p-2 rounded-sm text-muted-foreground hover:text-foreground focus:outline-none transition-all duration-200 ease-in-out\"\r\n                    aria-label=\"Backoffice\"\r\n                    title=\"Backoffice\"\r\n                  >\r\n                    <Icon name=\"shieldCheck\" className=\"w-6 h-6 cursor-pointer\" />\r\n                  </button>\r\n                )}\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={(e) => handleNavItemClick(e, \"/settings\")}\r\n                  className=\"p-2 rounded-sm text-muted-foreground hover:text-foreground focus:outline-none transition-all duration-300 ease-in-out hover:scale-110 hover:rotate-90\"\r\n                  aria-label=\"Settings\"\r\n                  title=\"Settings\"\r\n                >\r\n                  <Icon name=\"gear\" className=\"w-6 h-6 cursor-pointer\" />\r\n                </button>\r\n              </div>\r\n                </>\r\n              ) : (\r\n                <div className=\"flex items-center justify-between border-t border-border pt-3\">\r\n                  <Link\r\n                    href=\"/support\"\r\n                    onClick={(e) => handleNavItemClick(e, \"/support\")}\r\n                    className=\"text-sm text-muted-foreground hover:text-foreground transition-colors duration-200 ease-in-out\"\r\n                  >\r\n                    Need help?\r\n                  </Link>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={(e) => handleNavItemClick(e, \"/settings\")}\r\n                    className=\"p-2 rounded-sm text-muted-foreground hover:text-foreground focus:outline-none transition-all duration-300 ease-in-out hover:scale-110 hover:rotate-90\"\r\n                    aria-label=\"Settings\"\r\n                    title=\"Settings\"\r\n                  >\r\n                    <Icon name=\"gear\" className=\"w-6 h-6 cursor-pointer\" />\r\n                  </button>\r\n                </div>\r\n              )}\r\n              <Button onClick={handleLogout} className=\"w-full py-2\" variant=\"primary\">{isLoggedIn ? \"Log out\" : \"Log in\"}</Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {showNotifications && (\r\n        <div className=\"md:hidden fixed right-0 top-0 z-50\">\r\n          <NotificationOverlay isOpen={showNotifications} onClose={() => setShowNotifications(false)} />\r\n        </div>\r\n      )}\r\n\r\n      <aside className=\"hidden md:flex md:flex-col md:fixed md:inset-y-0 md:left-0 md:w-64 bg-background border-r-2 border-border/50 z-30\">\r\n        <div className=\"px-4 py-3 pt-10 flex justify-center\">\r\n          <button type=\"button\" onClick={() => guardedNavigate(\"/app\")} className=\"inline-flex items-center cursor-pointer\" aria-label=\"Home\">\r\n            <Logo width={160} height={40} />\r\n          </button>\r\n        </div>\r\n        <nav className=\"flex-1 overflow-y-auto px-3 py-4 space-y-1\">\r\n          <div className=\"mt-3\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Input className=\"flex-1\" placeholder=\"Search...\" value={searchQuery} onChange={handleSearchChange} onKeyDown={handleDesktopSearchKeyDown} />\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setShowFiltersModal(true)}\r\n                className={`inline-flex items-center justify-center h-10 w-10 rounded-md border border-border transition-colors ${hasActiveFilters ? \"bg-primary text-primary-foreground\" : \"text-foreground hover:bg-accent/20\"}`}\r\n                aria-pressed={hasActiveFilters}\r\n                aria-label=\"Open filters\"\r\n                title=\"Filter notes\"\r\n              >\r\n                <Icon name=\"filter\" className=\"w-4 h-4\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n          <div className=\"mt-4 space-y-1\">\r\n            {items.filter((item) => item.name !== \"Support\").map((item) => (\r\n              item.onClick ? (\r\n                <button key={item.href} onClick={(e) => { e.preventDefault(); item.onClick?.(e); }} className={`w-full flex items-center gap-3 p-3 rounded-sm hover:bg-accent/20 text-foreground cursor-pointer transition-colors duration-200 ease-in-out ${pathname === item.href || (item.name === 'Notifications' && showNotifications) ? 'bg-accent' : ''}`}>\r\n                  <div className=\"relative flex items-center\">\r\n                    <BadgeIcon name={item.icon} count={item.name === \"Notifications\" ? item.unreadNotifications ?? undefined : undefined} className=\"w-5 h-5\" />\r\n                  </div>\r\n                  <span className=\"font-medium text-sm\">{item.name}</span>\r\n                </button>\r\n              ) : (\r\n                <Link key={item.href} href={item.href} onClick={(e) => handleNavItemClick(e, item.href)} className={`flex items-center gap-2 p-3 rounded-sm hover:bg-accent/20 text-foreground cursor-pointer transition-colors duration-200 ease-in-out ${pathname === item.href || (item.name === 'Notifications' && showNotifications) ? 'bg-accent' : ''}`}>\r\n                  <div className=\"relative flex items-center\">\r\n                    <BadgeIcon name={item.icon} count={item.name === \"Notifications\" ? item.unreadNotifications ?? undefined : undefined} className=\"w-5 h-5\" />\r\n                  </div>\r\n                  <span className=\"font-medium text-sm\">{item.name}</span>\r\n                </Link>\r\n              )\r\n            ))}\r\n          </div>\r\n        </nav>\r\n        <div className=\"p-4 space-y-3\">\r\n          {mounted && isLoggedIn ? (\r\n            <>\r\n              <Link\r\n                href=\"/support\"\r\n                onClick={(e) => handleNavItemClick(e, \"/support\")}\r\n                className=\"block text-sm text-muted-foreground hover:text-foreground transition-colors duration-200 ease-in-out\"\r\n              >\r\n                Need help?\r\n              </Link>\r\n              <div className=\"flex items-center gap-3 border-t border-border pt-3\">\r\n                <button type=\"button\" onClick={() => guardedNavigate(\"/profile\")} className=\"flex items-center gap-3 flex-1 bg-transparent cursor-pointer text-left\">\r\n                  <div className=\"flex items-center justify-center w-10 h-10 rounded-full overflow-hidden bg-muted ring-1 ring-border/20 shadow-sm\">\r\n                    {localProfileImage ? (\r\n                      <img src={localProfileImage} alt=\"Profile photo\" className=\"w-full h-full object-cover\" />\r\n                    ) : (\r\n                      <div className=\"w-full h-full bg-secondary text-secondary-foreground font-semibold flex items-center justify-center\">{getInitials(userName || username || \"Anonymous\")}</div>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"flex flex-col\">\r\n                    <span className=\"text-sm font-semibold text-foreground\">{username || userName || \"Anonymous\"}</span>\r\n                  </div>\r\n                </button>\r\n                {!adminLoading && isAdmin && (\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={(e) => { e.preventDefault(); guardedNavigate(\"/admin\"); }}\r\n                    className=\"p-2 rounded-sm text-muted-foreground hover:text-foreground focus:outline-none transition-all duration-200 ease-in-out\"\r\n                    aria-label=\"Backoffice\"\r\n                    title=\"Backoffice\"\r\n                  >\r\n                    <Icon name=\"shieldCheck\" className=\"w-6 h-6 cursor-pointer\" />\r\n                  </button>\r\n                )}\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={(e) => handleNavItemClick(e, \"/settings\")}\r\n                  className=\"p-2 rounded-sm text-muted-foreground hover:text-foreground focus:outline-none transition-all hover:scale-110 hover:rotate-90\"\r\n                  aria-label=\"Settings\"\r\n                  title=\"Settings\"\r\n                >\r\n                  <Icon name=\"gear\" className=\"w-6 h-6 cursor-pointer\" />\r\n                </button>\r\n              </div>\r\n            </>\r\n          ) : (\r\n            <div className=\"flex items-center justify-between border-t border-border pt-3\">\r\n              <Link\r\n                href=\"/support\"\r\n                onClick={(e) => handleNavItemClick(e, \"/support\")}\r\n                className=\"text-sm text-muted-foreground hover:text-foreground transition-colors duration-200 ease-in-out\"\r\n              >\r\n                Need help?\r\n              </Link>\r\n              <button\r\n                type=\"button\"\r\n                onClick={(e) => handleNavItemClick(e, \"/settings\")}\r\n                className=\"p-2 rounded-sm text-muted-foreground hover:text-foreground focus:outline-none transition-all hover:scale-110 hover:rotate-90\"\r\n                aria-label=\"Settings\"\r\n                title=\"Settings\"\r\n              >\r\n                <Icon name=\"gear\" className=\"w-6 h-6 cursor-pointer\" />\r\n              </button>\r\n            </div>\r\n          )}\r\n          <Button onClick={handleLogout} variant=\"primary\" className=\"w-full\">{isLoggedIn ? \"Log out\" : \"Log in\"}</Button>\r\n        </div>\r\n      </aside>\r\n      <div className=\"hidden md:block md:fixed md:left-[16rem] md:top-0 z-40\">\r\n        <NotificationOverlay isOpen={showNotifications} onClose={() => setShowNotifications(false)} />\r\n      </div>\r\n\r\n      <LoginRequiredModal isOpen={showLoginModal} onClose={() => setShowLoginModal(false)} message=\"You must be logged in to access shared notes.\" />\r\n      <NotesFilterModal isOpen={showFiltersModal} onClose={() => setShowFiltersModal(false)} />\r\n    </>\r\n  );\r\n}\r\n\r\nfunction getPageTitle(pathname: string | null, items: NavItem[]): string {\r\n  if (!pathname) return \"Notus\";\r\n  const found = items.find((i) => i.href === pathname);\r\n  if (found) return found.name;\r\n  if (pathname === \"/\") return \"My notes\";\r\n  if (pathname === \"/profile\") return \"My account\";\r\n  if (pathname === \"/settings\") return \"Settings\";\r\n  if (pathname === \"/favorites\") return \"Favorites\";\r\n  if (pathname === \"/folders\") return \"Folders\";\r\n  if (pathname.startsWith(\"/folders/\")) return \"Folder\";\r\n  if (pathname === \"/support\") return \"Support\";\r\n  if (pathname === \"/trash\") return \"Trash\";\r\n  if (pathname.startsWith(\"/profile/edit\")) return \"Edit profile\";\r\n  return \"Notus\";\r\n}\r\n\r\nfunction getInitials(name: string | null): string {\r\n  if (!name) return \"?\";\r\n  const parts = String(name).trim().split(/\\s+/);\r\n  const first = parts[0]?.[0] || \"\";\r\n  const last = parts.length > 1 ? parts[parts.length - 1][0] : \"\";\r\n  return (first + last).toUpperCase() || \"?\";\r\n}\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\navigation\\Navigation.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\support\\RequestHistoryCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\support\\ViewModeSwitch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\UserList\\UserList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\UserList\\UserListButton.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":82,"column":11,"nodeType":"JSXOpeningElement","endLine":87,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useRef, useState } from \"react\";\r\nimport Icon from \"@/components/Icon\";\r\nimport UserList from \"./UserList\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ntype User = {\r\n  id: number;\r\n  name: string;\r\n  avatarUrl: string;\r\n  email?: string;\r\n  permission?: boolean;\r\n};\r\n\r\ninterface UserListButtonProps {\r\n  users: User[];\r\n  className?: string;\r\n  documentId?: number;\r\n  onAccessListRefresh?: () => Promise<void> | void;\r\n  isOwner?: boolean;\r\n  currentUserId?: string | number | null;\r\n}\r\n\r\nexport default function UserListButton({\r\n  users,\r\n  className,\r\n  documentId,\r\n  onAccessListRefresh,\r\n  isOwner,\r\n  currentUserId\r\n}: Readonly<UserListButtonProps>) {\r\n  const [errored, setErrored] = useState<{ [id: string]: boolean }>({});\r\n  const [open, setOpen] = useState(false);\r\n  const buttonRef = useRef<HTMLButtonElement>(null);\r\n  const overlayRef = useRef<HTMLDivElement>(null);\r\n\r\n  const userCount = users.length;\r\n  const hasMultipleUsers = userCount > 1;\r\n\r\n  // Close overlay on outside click (not when clicking inside overlay or button)\r\n  React.useEffect(() => {\r\n    if (!open) return;\r\n    function handleClick(e: MouseEvent) {\r\n      const target = e.target as Node;\r\n      // If the click is inside the toggle button, ignore\r\n      if (buttonRef.current?.contains(target)) return;\r\n      if (overlayRef.current?.contains(target)) return;\r\n      try {\r\n        const el = target as Element | null;\r\n        if (el && el instanceof Element) {\r\n          if (el.closest('[data-slot=\"dropdown-menu-content\"], [data-slot=\"dropdown-menu\"]')) {\r\n            return;\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Error in click outside handler:\", err);\r\n      }\r\n      setOpen(false);\r\n    }\r\n    document.addEventListener(\"mousedown\", handleClick);\r\n    return () => document.removeEventListener(\"mousedown\", handleClick);\r\n  }, [open]);\r\n\r\n  const renderAvatar = (user: User, index: number, size: \"lg\" | \"md\", showBadge?: boolean, badgeCount?: number) => {\r\n    const sizeClasses = {\r\n      lg: \"w-10 h-10 text-base\",\r\n      md: \"w-9 h-9 text-sm\",\r\n    };\r\n    const sizeValue = sizeClasses[size];\r\n    const hasAvatar = user.avatarUrl && user.avatarUrl !== \"\" && !errored[user.id];\r\n    const initial = user.name?.charAt(0)?.toUpperCase() || user.email?.charAt(0)?.toUpperCase() || \"?\";\r\n\r\n    return (\r\n      <span\r\n        key={user.id}\r\n        className={cn(\r\n          \"relative inline-flex items-center justify-center rounded-full bg-[var(--card)]\",\r\n          sizeValue,\r\n          index === 0 ? \"z-10\" : \"z-0\",\r\n        )}\r\n      >\r\n        {hasAvatar ? (\r\n          <img\r\n            src={user.avatarUrl}\r\n            alt={user.name}\r\n            className=\"w-full h-full rounded-full object-cover\"\r\n            onError={() => setErrored((e) => ({ ...e, [user.id]: true }))}\r\n          />\r\n        ) : (\r\n          <span className=\"w-full h-full rounded-full bg-[var(--secondary)] text-[var(--secondary-foreground)] flex items-center justify-center font-semibold\">\r\n            {initial}\r\n          </span>\r\n        )}\r\n        {showBadge && badgeCount !== undefined && badgeCount > 0 && (\r\n          <span\r\n            className={cn(\r\n              \"absolute -bottom-0.5 -right-0.5 flex items-center justify-center rounded-full\",\r\n              \"bg-[var(--primary)] text-[var(--primary-foreground)]\",\r\n              \"border-2 border-[var(--card)]\",\r\n              \"text-[10px] font-semibold leading-none\",\r\n              \"min-w-[1.125rem] h-[1.125rem] px-1\"\r\n            )}\r\n            title={`${badgeCount} other user${badgeCount > 1 ? \"s\" : \"\"}`}\r\n          >\r\n            +{badgeCount}\r\n          </span>\r\n        )}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className={cn(\"relative inline-block\", className)}>\r\n      <button\r\n        ref={buttonRef}\r\n        onClick={() => setOpen((v) => !v)}\r\n        type=\"button\"\r\n        aria-label={`${userCount} user${userCount > 1 ? \"s\" : \"\"} connected`}\r\n        aria-expanded={open}\r\n        className={cn(\r\n          \"relative flex items-center justify-center gap-2 px-2 py-1.5 rounded-lg cursor-pointer\",\r\n          \"hover:bg-background transition-colors\",\r\n          hasMultipleUsers ? \"pr-3\" : \"pr-2.5\"\r\n        )}\r\n      >\r\n        <div className={cn(\"flex items-center\", hasMultipleUsers ? \"-space-x-2\" : \"\")}>\r\n          {users[0] && renderAvatar(users[0], 0, \"lg\")}\r\n          {users[1] && renderAvatar(users[1], 1, \"md\", userCount > 2, userCount > 2 ? userCount - 2 : undefined)}\r\n        </div>\r\n\r\n        <span\r\n          className={cn(\r\n            \"flex items-center justify-center shrink-0\",\r\n            \"text-[var(--muted-foreground)]\",\r\n            \"transition-transform duration-200\",\r\n            open && \"rotate-180\"\r\n          )}\r\n        >\r\n          <Icon name=\"chevronDown\" className={cn(hasMultipleUsers ? \"w-4 h-4\" : \"w-3.5 h-3.5\")} />\r\n        </span>\r\n      </button>\r\n\r\n      {open && (\r\n        <>\r\n          <div\r\n            className=\"fixed inset-0 z-40\"\r\n            onClick={() => setOpen(false)}\r\n            aria-hidden=\"true\"\r\n          />\r\n          <div\r\n            ref={overlayRef}\r\n            className={cn(\r\n              \"absolute mt-2 z-50 min-w-56 max-w-sm\",\r\n              \"bg-[var(--card)] text-[var(--card-foreground)]\",\r\n              \"rounded-xl shadow-lg border border-[var(--border)]\",\r\n              \"p-2 left-auto right-0 w-auto\"\r\n            )}\r\n          >\r\n            <UserList\r\n              users={users.map((u) => ({\r\n                ...u,\r\n                id: Number(u.id),\r\n                permission: u.permission ?? false,\r\n              }))}\r\n              currentUserId={currentUserId ?? undefined}\r\n              documentId={documentId ?? (users[0]?.id ?? (undefined as any))}\r\n              onChanged={onAccessListRefresh}\r\n              isOwner={isOwner}\r\n            />\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\alert.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\dropdown-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\filter-modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\form.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\image-upload.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\layout\\back-header.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\layout\\documents-grid.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\layout\\page-center.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\loading-spinner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\logo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\notifications\\badge-icon.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\notifications\\notification-item.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":105,"column":21,"nodeType":"JSXOpeningElement","endLine":110,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from \"react\";\r\nimport Icon from \"@/components/Icon\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { deleteNotification } from \"@/actions/notificationActions\";\r\n\r\ninterface NotificationItemProps {\r\n    avatar?: string | null;\r\n    username: string;\r\n    id_sender?: number | null;\r\n    message: string;\r\n    notificationId?: number; // id of the notification to delete\r\n    onClick?: () => void;\r\n    onDelete?: (id: number) => void; // optional callback after successful delete\r\n    onMarkRead?: (id: number) => void; // optional callback to mark as read\r\n    isRead?: boolean;\r\n}\r\n\r\nexport default function NotificationItem({\r\n    avatar,\r\n    username,\r\n    id_sender,\r\n    message,\r\n    notificationId,\r\n    onClick,\r\n    onDelete,\r\n    onMarkRead,\r\n    isRead = false,\r\n}: Readonly<NotificationItemProps>) {\r\n    const isSystem = id_sender !== undefined\r\n        ? id_sender === null\r\n        : (username || \"\").toLowerCase() === \"system\" || avatar === \"system\";\r\n\r\n    const normalizedAvatar = typeof avatar === \"string\" ? avatar.trim() : \"\";\r\n    const hasAvatar = !!normalizedAvatar && normalizedAvatar !== \"null\" && normalizedAvatar !== \"undefined\";\r\n\r\n    const [imgError, setImgError] = React.useState(false);\r\n    const [deleting, setDeleting] = React.useState(false);\r\n    const [marking, setMarking] = React.useState(false);\r\n\r\n    React.useEffect(() => {\r\n        setImgError(false);\r\n    }, [normalizedAvatar]);\r\n\r\n    const handleDeleteClick = (e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        if (deleting) return;\r\n        performDelete();\r\n    };\r\n\r\n    const performDelete = async () => {\r\n        if (!notificationId || deleting) return;\r\n        setDeleting(true);\r\n        try {\r\n            const result = await deleteNotification(notificationId);\r\n            if (!result.success) {\r\n                const errMsg = result.error || \"Unknown error\";\r\n                console.error(\"Failed to delete notification:\", errMsg);\r\n                alert(\"Failed to delete notification: \" + errMsg);\r\n                return;\r\n            }\r\n            onDelete?.(notificationId);\r\n        } catch (err) {\r\n            console.error(\"Failed to delete notification\", err);\r\n            alert(\"Failed to delete notification\");\r\n        } finally {\r\n            setDeleting(false);\r\n        }\r\n    };\r\n\r\n    const handleMarkRead = async (e: React.MouseEvent) => {\r\n        e.stopPropagation();\r\n        if (!notificationId || marking || isRead) return;\r\n        setMarking(true);\r\n        try {\r\n            onMarkRead?.(notificationId);\r\n        } catch (err) {\r\n            console.error(\"mark read failed\", err);\r\n        } finally {\r\n            setMarking(false);\r\n        }\r\n    };\r\n\r\n    const handleKeyDown = (e: React.KeyboardEvent) => {\r\n        if (e.key === \"Enter\" || e.key === \" \") {\r\n            e.preventDefault();\r\n            onClick?.();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n        <div\r\n            role=\"button\"\r\n            tabIndex={0}\r\n            onClick={onClick}\r\n            onKeyDown={handleKeyDown}\r\n            className={cn(\r\n                \"w-full flex flex-row items-center text-left px-3 py-2 rounded hover:bg-muted text-foreground\",\r\n                onClick && \"cursor-pointer\"\r\n            )}\r\n        >\r\n            {isSystem ? null : (\r\n                hasAvatar && !imgError ? (\r\n                    <img\r\n                        src={normalizedAvatar}\r\n                        alt={username || \"avatar\"}\r\n                        className=\"w-8 h-8 rounded-full mr-3 object-cover\"\r\n                        onError={() => setImgError(true)}\r\n                    />\r\n                ) : (\r\n                    <div className=\"w-8 h-8 rounded-full mr-3 bg-muted flex items-center justify-center text-xs text-muted-foreground\">\r\n                    </div>\r\n                )\r\n            )}\r\n\r\n            <div className=\"flex-1 flex flex-col min-w-0\">\r\n                <div className=\"flex items-center justify-between gap-2\">\r\n                    <span className=\"font-medium text-sm\">{isSystem ? \"System\" : username || \"User\"}</span>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        {!isRead && (\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={handleMarkRead}\r\n                                className=\"p-1 rounded hover:bg-accent/50 text-muted-foreground\"\r\n                                title=\"Mark as read\"\r\n                                aria-label=\"Mark as read\"\r\n                                disabled={marking}\r\n                            >\r\n                                <Icon name=\"check\" className=\"w-4 h-4\" />\r\n                            </button>\r\n                        )}\r\n\r\n                        {/* Trash button */}\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={handleDeleteClick}\r\n                            className={`ml-2 p-1 rounded hover:bg-accent/50 text-muted-foreground ${deleting ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n                            title=\"Delete notification\"\r\n                            aria-label=\"Delete notification\"\r\n                            disabled={deleting}\r\n                        >\r\n                            <Icon name=\"trash\" className=\"w-4 h-4\" />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n                <span className={cn(\"text-sm text-muted-foreground max-w-[260px] break-words\")} title={message || \"\"}>\r\n                    {message || \"\"}\r\n                </span>\r\n            </div>\r\n        </div>\r\n        {/* immediate delete ÔÇö no confirmation popin */}\r\n        </>\r\n    );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\overlay\\overlay-menu-item.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\scroll-area.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\separator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\status-circle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\textarea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\components\\ui\\unread-count.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\contexts\\DrawingContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\contexts\\NotificationContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\contexts\\SearchContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\contexts\\SelectionContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\contexts\\TagsContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\contexts\\ThemeContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\hooks\\UseTextFormatting.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\hooks\\useGuardedNavigate.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\hooks\\useImageValidation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\hooks\\useLocalSession.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\actions\\DocumentActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\actions\\UserActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\actions\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\actions\\server-only\\ServerActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\colorPalette.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\documentHistory.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\dom-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\export-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\admin\\AdminActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\admin\\AdminService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\admin\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\authentication\\AuthActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\authentication\\AuthService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\authentication\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\document-management\\DocumentActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\document-management\\DocumentService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\document-management\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\email\\EmailService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\email\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\user-management\\PasswordService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\user-management\\UserManagementActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\user-management\\UserProfileService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\user-management\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\validation\\ValidationService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\modules\\validation\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\paper.js\\cursorUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\paper.js\\debounce.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\paper.js\\export.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\paper.js\\localStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\paper.js\\socket-client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\paper.js\\socket-server.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\paper.js\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\paper.js\\useCollaborativeNote.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\paper.js\\useCollaborativeTitle.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\paper.js\\useCursorTracking.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\prisma.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\repositories\\BaseRepository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\repositories\\DocumentRepository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\repositories\\NotificationRepository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\repositories\\PrismaDocumentRepository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\repositories\\PrismaUserRepository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\repositories\\RequestRepository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\repositories\\UserRepository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\reset-database.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\sanitizeHtml.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\sanitizeLinks.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\security\\apiPolicies.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\security\\routeGuards.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\services\\DocumentService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\services\\EmailService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\services\\NotificationService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\services\\PrismaDocumentService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\services\\PrismaUserService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\services\\RequestService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\services\\UserService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\session-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\validators\\DocumentValidator.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\lib\\validators\\UserValidator.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\pages\\api\\socket.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\louis\\Folders\\Notus-Rework\\src\\types\\window.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
